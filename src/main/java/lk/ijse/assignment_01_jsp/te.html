
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Category Management</title>
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="styles.css"> <!-- Optional for custom styles -->
</head>
<body>

<!-- Header Section -->
<header class="bg-primary text-white p-3">
    <div class="container d-flex justify-content-between align-items-center">
        <h1>Admin Dashboard</h1>
        <nav>
            <a href="home.jsp" class="text-white me-3">Home</a>
            <a href="user_management.jsp" class="text-white me-3">Users</a>
            <a href="category_management.jsp" class="text-white me-3">Category</a>
            <a href="product_management.jsp" class="text-white me-3">Products</a>
            <a href="order_management.jsp" class="text-white me-3">Orders</a>
            <a href="logout.jsp" class="text-white"><i class="bi bi-box-arrow-right"></i> Logout</a>
        </nav>
    </div>
</header>

<!-- Main Section -->
<main class="container my-5">
    <h2 class="mb-4">Category Management</h2>

    <!-- Search and Add Category -->
    <div class="d-flex justify-content-between align-items-center mb-3">
        <input type="text" class="form-control w-25" placeholder="Search Categories...">
        <button class="btn btn-success" data-bs-toggle="modal" data-bs-target="#addCategoryModal">Add Category</button>
    </div>

    <!-- Category Table -->
    <table class="table table-bordered">
        <thead class="table-dark">
        <tr>
            <th>Category Code</th>
            <th>Category Name</th>
            <th>Description</th>
            <th>Actions</th>
        </tr>
        </thead>
        <tbody>
        <%
        // Retrieve categories from backend
        List<Category> categories = (List<Category>) request.getAttribute("categories");
            if (categories != null && !categories.isEmpty()) {
            for (Category category : categories) {
            %>
            <tr>
                <td><%= category.getCategoryCode() %></td>
                <td><%= category.getCategoryName() %></td>
                <td><%= category.getDescription() %></td>
                <td>
                    <button class="btn btn-primary btn-sm" data-bs-toggle="modal" data-bs-target="#editCategoryModal"
                            data-categorycode="<%= category.getCategoryCode() %>"
                            data-categoryname="<%= category.getCategoryName() %>"
                            data-description="<%= category.getDescription() %>">
                        Edit
                    </button>
                    <button class="btn btn-danger btn-sm" data-bs-toggle="modal" data-bs-target="#deleteCategoryModal"
                            data-categorycode="<%= category.getCategoryCode() %>">
                        Delete
                    </button>
                </td>
            </tr>
            <%
            }
            } else {
            %>
            <tr>
                <td colspan="4" class="text-center">No categories found</td>
            </tr>
            <% } %>
        </tbody>
    </table>
</main>

<!-- Add Category Modal -->
<div class="modal fade" id="addCategoryModal" tabindex="-1" aria-labelledby="addCategoryModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <form action="addCategory" method="post">
                <div class="modal-header">
                    <h5 class="modal-title" id="addCategoryModalLabel">Add Category</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <div class="mb-3">
                        <label for="categoryName" class="form-label">Category Name</label>
                        <input type="text" class="form-control" id="categoryName" name="categoryName" required>
                    </div>
                    <div class="mb-3">
                        <label for="description" class="form-label">Description</label>
                        <input type="text" class="form-control" id="description" name="description" required>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="submit" class="btn btn-success">Add Category</button>
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                </div>
            </form>
        </div>
    </div>
</div>

<!-- Edit Category Modal -->
<div class="modal fade" id="editCategoryModal" tabindex="-1" aria-labelledby="editCategoryModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <form action="updateCategory" method="post">
                <div class="modal-header">
                    <h5 class="modal-title" id="editCategoryModalLabel">Edit Category</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <input type="hidden" id="editCategoryCode" name="categoryCode">
                    <div class="mb-3">
                        <label for="editCategoryName" class="form-label">Category Name</label>
                        <input type="text" class="form-control" id="editCategoryName" name="categoryName" required>
                    </div>
                    <div class="mb-3">
                        <label for="editDescription" class="form-label">Description</label>
                        <input type="text" class="form-control" id="editDescription" name="description" required>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="submit" class="btn btn-primary">Update Category</button>
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                </div>
            </form>
        </div>
    </div>
</div>

<!-- Delete Category Modal -->
<div class="modal fade" id="deleteCategoryModal" tabindex="-1" aria-labelledby="deleteCategoryModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <form action="deleteCategory" method="post">
                <div class="modal-header">
                    <h5 class="modal-title" id="deleteCategoryModalLabel">Delete Category</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <p>Are you sure you want to delete this category?</p>
                    <input type="hidden" id="deleteCategoryCode" name="categoryCode">
                </div>
                <div class="modal-footer">
                    <button type="submit" class="btn btn-danger">Delete</button>
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                </div>
            </form>
        </div>
    </div>
</div>

<!-- Footer -->
<footer class="bg-dark text-white text-center py-3">
    <p>&copy; 2025 Category Management System. All rights reserved.</p>
</footer>

<!-- Bootstrap JS -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha3/dist/js/bootstrap.bundle.min.js"></script>

<!-- Modal Pre-fill Script -->
<script>
    const editCategoryModal = document.getElementById('editCategoryModal');
    const deleteCategoryModal = document.getElementById('deleteCategoryModal');

    editCategoryModal.addEventListener('show.bs.modal', function (event) {
        const button = event.relatedTarget;
        const categoryCode = button.getAttribute('data-categorycode');
        const categoryName = button.getAttribute('data-categoryname');
        const description = button.getAttribute('data-description');

        document.getElementById('editCategoryCode').value = categoryCode;
        document.getElementById('editCategoryName').value = categoryName;
        document.getElementById('editDescription').value = description;
    });

    deleteCategoryModal.addEventListener('show.bs.modal', function (event) {
        const button = event.relatedTarget;
        const categoryCode = button.getAttribute('data-categorycode');

        document.getElementById('deleteCategoryCode').value = categoryCode;
    });
</script>

</body>
</html>
